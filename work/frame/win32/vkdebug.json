{
	"version": 2,
	"engine": "NebulaTrifid",
	"framescript": 
	{
		"renderTextures":
		[
			{ "name": "NormalBuffer", 	"format": "A8R8G8B8", 		"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "DepthBuffer", 	"format": "R32F", 			"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "AlbedoBuffer", 	"format": "A8R8G8B8", 		"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "SpecularBuffer", "format": "A8R8G8B8", 		"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "EmissiveBuffer", "format": "A16B16G16R16F", 	"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "LightBuffer", 	"format": "A16B16G16R16F", 	"relative": true, "width": 1.0, "height": 1.0 },
			{ "name": "__WINDOW__" }
		],
		
		"depthStencils":
		[
			{ "name":"DepthBuffer", "format":"D32S8", "relative": true, "width": 1.0, "height": 1.0 }
		],
		
		"globalState":
		{
			"name":"DeferredTextures",
			"variables":
			[
				{ "semantic":"DepthBuffer", 	"value":"DepthBuffer" },
				{ "semantic":"NormalBuffer", 	"value":"NormalBuffer" },
				{ "semantic":"AlbedoBuffer", 	"value":"AlbedoBuffer" },
				{ "semantic":"SpecularBuffer", 	"value":"SpecularBuffer" },
				{ "semantic":"EmissiveBuffer", 	"value":"EmissiveBuffer" },
				{ "semantic":"LightBuffer", 	"value":"LightBuffer" }
			]
		},
		
		"pass":
		{
			"name": "DeferredPass",
			"attachments":
			[
				{ "name": "NormalBuffer", 	"clear":"0.5, 0.5, 0, 0", "store": true },
				{ "name": "DepthBuffer", 	"clear":"-1000, 0, 0, 0", "store": true },
				{ "name": "SpecularBuffer", "clear":"0, 0, 0, 0" },
				{ "name": "AlbedoBuffer", 	"clear":"0.1, 0.1, 0.1, 1" },
				{ "name": "EmissiveBuffer", "clear":"0, 0, 0, -1" },
				{ "name": "LightBuffer", 	"clear":"0.1, 0.1, 0.1, 0.1", "store": true },
				{ "name": "__WINDOW__" }
			],
			
			"depthStencil": { "name": "DepthBuffer", "clear": 1, "clearStencil": 0, "store": true },
			
			"subpass":
			{
				"name": "GeometryPass",
				"dependencies": [], 
				"attachments": [0, 1, 2, 3, 4],
				"depth": true,
				"batch": "FlatGeometryLit", 
				"batch": "TesselatedGeometryLit"
			},
			"subpass":
			{
				"name": "LightPass",
				"dependencies": [ "GeometryPass" ],
				"inputs": [0, 1, 2, 3, 4],
				"depth": true,
				"attachments": [5],
				"system": "Lights"
			},
			"subpass":
			{
				"name": "Unlit",
				"dependencies": [ "LightPass" ],
				"attachments": [5],
				"depth": true,
				"batch": "Unlit"
			},
			"subpass":
			{
				"name": "FinishPass",
				"dependencies": [ "Unlit" ],
				"inputs": [6],
				"attachments": [6],
				"fullscreenEffect": 
				{
					"name":"ToScreen",
					"shader":"shd:aaa",
					"sizeFromTexture":"__WINDOW__",
					"variables":
					[
						{ "semantic": "CopyBuffer", "value": "LightBuffer" }
					]
				},
				"system": "UI",
				"subpassAlgorithm": 
				{ 
					"name": "TestSubpassAlgorithm", 
					"algorithm": "", 
					"phase": 1 
				}
			}
		}
	}
}